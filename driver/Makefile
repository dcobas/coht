###############################################################################
# @file Makefile.drvr
#
# @brief Linux/Lynx Cvorb driver compilation.
#
# Automatically generated by driver-gen
#
# @author Copyright (C) 2003-2010 CERN. Yury GEORGIEVSKIY <ygeorgie@cern.ch>
#
# @date Created on 22/01/2010
#
# @section license_sec License
#          Released under the GPL
###############################################################################

ifeq ($(MAKECMDGOALS), linux)
	CPU=L865
else ifeq ($(MAKECMDGOALS), lynx)
	CPU=ppc4
endif

include ../Makefile.base
include ../Makefile.specific

all:
	@$(MAKE) linux
	@$(MAKE) lynx

linux:
	@./compiledrvr linux $(KVER)

lynx:
	@./compiledrvr lynx $(KVER)

# CERN delivery
include ../deliver.mk
ifeq ("$(origin KVER)", "command line")
ifneq ($(findstring 2.6,$(KVER)),)
deliver:
	$(Q)$(MAKE) _deliver $(filter $(strip $(ACCS)),$(MAKECMDGOALS)) CPU=L865
else
deliver:
	$(Q)$(MAKE) _deliver $(filter $(strip $(ACCS)),$(MAKECMDGOALS)) CPU=ppc4
endif
else
deliver:
	$(Q)$(MAKE) _deliver $(filter $(strip $(ACCS)),$(MAKECMDGOALS)) CPU=L865
	$(Q)$(MAKE) _deliver $(filter $(strip $(ACCS)),$(MAKECMDGOALS)) CPU=ppc4
endif
